U2F Security Bundle
===================

This Symfony bundle aim to add a two factor security level to your Symfony project.

Overview
--------

If you want to use U2F security keys as second level security, you have 3 options :

1. You are a true warrior and make it all from scratch
2. You use a third party library and create a wrapper around it
3. You use this bundle :-)

This U2F Security Bundle is a wrapper around the [samyoul/u2f-php-server](https://github.com/Samyoul/U2F-php-server) library.

It move all the complexity to the wrapper and all you need is creating entities, making some calls from your controller, and displaying a beautiful form in a beautiful page. That all (for the basics).

Requirements
------------

Before installing this bundle you need to have an already working login and secured area in the Symfony way (aka security bundle, firewall and user entity).

Important point, U2F keys only work on HTTPS requests. So you will need an SSL certificate, even for working on localhost. The good news is that you can use self-signed certificate without problem.

Installation
------------

Now let's start together !

First you need to install the bundle through composer !

`composer require mbarbey/u2f-security-bundle`

Great ! It was easy uh ? Now let's create some entities.

First, we will create a "key" entity which will store the data of the U2F keys. You have two options :

1. Create a new entity and extends the class `Mbarbey\U2fSecurityBundle\Model\Key\U2fKey`.
2. Create a new entity and implement the interface `Mbarbey\U2fSecurityBundle\Model\Key\U2fKeyInterface`. If you pick this choice, don't forget to set the variables `$keyHandle`, `$publicKey`, `$certificate` and `$counter` public. This is actually needed by the used library. You can look at the `Mbarbey\U2fSecurityBundle\Model\Key\U2fKey` class if you need some inspiration.


Well done, now let's work more with the entities.

You need to edit a little bit your exising `user` entity used by your firewall to be linked to the newly created entity for the U2F keys. Again, you have two options :

1. Extends the class `Mbarbey\U2fSecurityBundle\Model\User\U2fUser`.
2. Implement the interface `Mbarbey\U2fSecurityBundle\Model\User\U2fUserInterface` and add the missing functions (`getU2fKeys`, `addU2fKey` and `removeU2fKey`).


Excellent, you have created all the required entities. Now we will need two model which will store the forms data.

You will have to create an empty authentication model which will extends the `Mbarbey\U2fSecurityBundle\Model\U2fAuthentication\U2fAuthentication` class. If you need to, you can add additional data to this model which will store the challenge response generated by the U2F keys, on the authentication page dispayed juste after being logged in.

Next you will have to create an empty registration model which will extends the `Mbarbey\U2fSecurityBundle\Model\U2fRegistration\U2fRegistration` class. Again, if you need to, you can add additional data to this model which will store the identification of the U2F key which will be attached to a user. For example, you can give a name to the keys so the user can recognise them ;-)


Bravo, you have made 80% of the work. Now let's do some easier tasks.


Next part coming soon.